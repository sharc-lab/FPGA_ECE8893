# Lab 1 – Loop Optimization Warm-Up

## Overview

In this lab, we will cover the fundamentals of HLS design using a simple two-phase numerical kernel:

1. Row-wise normalization  
2. Column-wise scaling  

You are given a completely unoptimized baseline implementation (`top.cpp`).  
Your goal is to improve performance through **loop-level optimizations**, such as:

- Loop pipelining  
- Selective loop unrolling  
- Loop reordering  
- Array partitioning  
- Other legal transformations discussed in lecture  

This lab focuses only on single-kernel, loop-level performance, no dataflow yet.

---

## How to Run

1. **C Compilation & Simulation**  
   Run: `make`, then run: `./result.out`. Ensure the program prints **TEST PASSED** before measuring performance.

2. **HLS Synthesis**  
Run: `vitis-run --tcl script.tcl`. This will run synthesis and generate the performance and resource reports.

---

## Notes and Submission Instructions

### **Provided Files**
- `dcl.h`: shared data types and kernel declaration  
- `top.cpp`: baseline HLS kernel (**this is the only file you should modify**)  
- `host.cpp`: CPU golden reference and correctness checker  

### **Do NOT change**
- Function signatures  
- Array sizes or data types  
- `dcl.h` or `host.cpp`  
- Any filenames or directory structure  

---

## What to Submit

### **1. Your optimized `top.cpp`**
- We will drop this file into the original folder and test correctness and performance.  
- **Your kernel must pass the correctness check** in `host.cpp` to be eligible for ranking and full credit.

### **2. A simple report (in a single `PDF`) containing:**
- Screenshot of HLS synthesized latency
- Screenshot of C/RTL co-simulation latency and clock period
- Screenshot of post-implementation resource utilization
  - Show LUT, FF, BRAM, DSP usage
  - The implementation must complete synthesis, placement, and routing without errors
- **Your final speedup ratio**  
  - Computed relative to the provided baseline
  - Use `number_of_clock_cycles * clock_period` to compute latency

## When to Submit

This lab uses a **two-deadline** system to encourage early correctness and iterative optimization:

- **Initial deadline:**  
  Submit a functionally correct `top.cpp` with a **speedup > 1** (i.e., do not submit the unoptimized baseline).  
  Missing this deadline results in a **30% score penalty**.

- **Final deadline:**  
  Keep optimizing and submit your **best version** by this date.  
  Your best result before the final deadline determines your ranking.



---

## Individual Assignment

This is an **individual assignment**.

You may discuss high-level ideas and optimization strategies, but:

- Do not share code
- Do not look at other students’ implementations
- Do not submit code generated by someone else

All submissions will be checked for similarity.

---

## Tips

- Start with inner-loop pipelining.  
- Use unrolling carefully—too aggresive unrolling will cause extremely long synthesis time and failed implementation 
- Array partitioning can help reduce access bottlenecks.  
- Check correctness early and often.  
- Do not over-optimize before confirming the kernel still passes the golden-checker.

---